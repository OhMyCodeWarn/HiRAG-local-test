"""
Ссылка:
 - Промты взяты из [graphrag](https://github.com/microsoft/graphrag)
"""

GRAPH_FIELD_SEP = "<SEP>"
PROMPTS = {}

PROMPTS[
    "claim_extraction"
] = """-Целевая деятельность-
Вы интеллектуальный ассистент, который помогает человеку-аналитику анализировать утверждения против определенных сущностей, представленных в текстовом документе.

-Цель-
Учитывая текстовый документ, который потенциально имеет отношение к данной деятельности, спецификацию сущности и описание утверждения, извлеките все сущности, которые соответствуют спецификации сущности, и все утверждения против этих сущностей.

-Шаги-
1. Извлеките все именованные сущности, которые соответствуют предопределенной спецификации сущности. Спецификация сущности может быть либо списком имен сущностей, либо списком типов сущностей.
2. Для каждой сущности, идентифицированной на шаге 1, извлеките все утверждения, связанные с этой сущностью. Утверждения должны соответствовать указанному описанию утверждения, а сущность должна быть субъектом утверждения.
Для каждого утверждения извлеките следующую информацию:
- Субъект: имя сущности, которая является субъектом утверждения, с большой буквы. Субъект сущности - это тот, кто совершил действие, описанное в утверждении. Субъект должен быть одной из именованных сущностей, идентифицированных на шаге 1.
- Объект: имя сущности, которая является объектом утверждения, с большой буквы. Объект сущности - это тот, кто либо сообщает/обрабатывает, либо затрагивается действием, описанным в утверждении. Если объект сущности неизвестен, используйте **НЕТ**.
- Тип утверждения: общая категория утверждения, с большой буквы. Назовите его таким образом, чтобы он мог повторяться в нескольких текстовых входах, так чтобы похожие утверждения имели одинаковый тип утверждения
- Статус утверждения: **ИСТИННО**, **ЛОЖНО** или **ПОДОЗРИТЕЛЬНО**. ИСТИННО означает, что утверждение подтверждено, ЛОЖНО означает, что утверждение оказалось ложным, ПОДОЗРИТЕЛЬНО означает, что утверждение не проверено.
- Описание утверждения: Подробное описание, объясняющее обоснование утверждения, вместе со всеми связанными доказательствами и ссылками.
- Дата утверждения: Период (дата_начала, дата_окончания), когда утверждение было сделано. И дата_начала, и дата_окончания должны быть в формате ISO-8601. Если утверждение было сделано в одну дату, а не в диапазоне дат, установите одинаковую дату для дата_начала и дата_окончания. Если дата неизвестна, верните **НЕТ**.
- Исходный текст утверждения: Список **всех** цитат из исходного текста, которые имеют отношение к утверждению.

Отформатируйте каждое утверждение как ({subject_entity}{tuple_delimiter}{object_entity}{tuple_delimiter}{claim_type}{tuple_delimiter}{claim_status}{tuple_delimiter}{claim_start_date}{tuple_delimiter}{claim_end_date}{tuple_delimiter}{claim_description}{tuple_delimiter}{claim_source})

3. Верните результат на русском языке как единый список всех утверждений, идентифицированных на шагах 1 и 2. Используйте **{record_delimiter}** в качестве разделителя списка.

4. По завершении выведите {completion_delimiter}

-Примеры-
Пример 1:
Спецификация сущности: организация
Описание утверждения: красные флаги, связанные с сущностью
Текст: Согласно статье от 2022/01/10, Компания А была оштрафована за сговор на торгах при участии в нескольких публичных тендерах, опубликованных Правительственным агентством Б. Компания принадлежит Лицу В, которое подозревалось в коррупционной деятельности в 2015 году.
Результат:

(КОМПАНИЯ А{tuple_delimiter}ПРАВИТЕЛЬСТВЕННОЕ АГЕНТСТВО Б{tuple_delimiter}АНТИКОНКУРЕНТНАЯ ПРАКТИКА{tuple_delimiter}ИСТИННО{tuple_delimiter}2022-01-10T00:00:00{tuple_delimiter}2022-01-10T00:00:00{tuple_delimiter}Компания А была признана виновной в антиконкурентной практике, поскольку была оштрафована за сговор на торгах в нескольких публичных тендерах, опубликованных Правительственным агентством Б, согласно статье, опубликованной 2022/01/10{tuple_delimiter}Согласно статье, опубликованной 2022/01/10, Компания А была оштрафована за сговор на торгах при участии в нескольких публичных тендерах, опубликованных Правительственным агентством Б.)
{completion_delimiter}

Пример 2:
Спецификация сущности: Компания А, Лицо В
Описание утверждения: красные флаги, связанные с сущностью
Текст: Согласно статье от 2022/01/10, Компания А была оштрафована за сговор на торгах при участии в нескольких публичных тендерах, опубликованных Правительственным агентством Б. Компания принадлежит Лицу В, которое подозревалось в коррупционной деятельности в 2015 году.
Результат:

(КОМПАНИЯ А{tuple_delimiter}ПРАВИТЕЛЬСТВЕННОЕ АГЕНТСТВО Б{tuple_delimiter}АНТИКОНКУРЕНТНАЯ ПРАКТИКА{tuple_delimiter}ИСТИННО{tuple_delimiter}2022-01-10T00:00:00{tuple_delimiter}2022-01-10T00:00:00{tuple_delimiter}Компания А была признана виновной в антиконкурентной практике, поскольку была оштрафована за сговор на торгах в нескольких публичных тендерах, опубликованных Правительственным агентством Б, согласно статье, опубликованной 2022/01/10{tuple_delimiter}Согласно статье, опубликованной 2022/01/10, Компания А была оштрафована за сговор на торгах при участии в нескольких публичных тендерах, опубликованных Правительственным агентством Б.)
{record_delimiter}
(ЛИЦО В{tuple_delimiter}НЕТ{tuple_delimiter}КОРРУПЦИЯ{tuple_delimiter}ПОДОЗРИТЕЛЬНО{tuple_delimiter}2015-01-01T00:00:00{tuple_delimiter}2015-12-30T00:00:00{tuple_delimiter}Лицо В подозревалось в коррупционной деятельности в 2015 году{tuple_delimiter}Компания принадлежит Лицу В, которое подозревалось в коррупционной деятельности в 2015 году)
{completion_delimiter}

-Реальные данные-
Используйте следующий ввод для вашего ответа.
Спецификация сущности: {entity_specs}
Описание утверждения: {claim_description}
Текст: {input_text}
Результат: """

PROMPTS[
    "community_report"
] = """Вы AI-ассистент, который помогает человеку-аналитику выполнять общее обнаружение информации. 
Обнаружение информации - это процесс выявления и оценки релевантной информации, связанной с определенными сущностями (например, организациями и индивидуумами) в сети.

# Цель
Напишите всеобъемлющий отчет о сообществе, учитывая список сущностей, которые принадлежат к сообществу, а также их отношения и необязательные связанные утверждения. Отчет будет использоваться для информирования лиц, принимающих решения, об информации, связанной с сообществом и их потенциальным влиянием. Содержание этого отчета включает обзор ключевых сущностей сообщества, их правовое соответствие, технические возможности, репутацию и заслуживающие внимания утверждения.

# Структура отчета

Отчет должен включать следующие разделы:

- ЗАГОЛОВОК: название сообщества, которое представляет его ключевые сущности - заголовок должен быть коротким, но конкретным. По возможности включите репрезентативные именованные сущности в заголовок.
- РЕЗЮМЕ: Краткое изложение общей структуры сообщества, того, как его сущности связаны друг с другом, и значимой информации, связанной с его сущностями.
- РЕЙТИНГ СЕРЬЕЗНОСТИ ВОЗДЕЙСТВИЯ: числовая оценка от 0-10, которая представляет серьезность ВОЗДЕЙСТВИЯ, оказываемого сущностями в сообществе. ВОЗДЕЙСТВИЕ - это оцененная важность сообщества.
- ОБЪЯСНЕНИЕ РЕЙТИНГА: Дайте однозначное объяснение рейтинга серьезности ВОЗДЕЙСТВИЯ.
- ДЕТАЛЬНЫЕ ВЫВОДЫ: Список из 5-10 ключевых выводов о сообществе. Каждый вывод должен иметь краткое резюме, за которым следуют несколько абзацев пояснительного текста, обоснованного согласно правилам обоснования ниже. Будьте всеобъемлющими.

Верните результат в виде правильно сформированной строки в формате JSON со следующим форматом:
    {{
        "title": <заголовок_отчета>,
        "summary": <краткое_изложение>,
        "rating": <рейтинг_серьезности_воздействия>,
        "rating_explanation": <объяснение_рейтинга>,
        "findings": [
            {{
                "summary":<резюме_вывода_1>,
                "explanation": <объяснение_вывода_1>
            }},
            {{
                "summary":<резюме_вывода_2>,
                "explanation": <объяснение_вывода_2>
            }}
            ...
        ]
    }}

# Правила обоснования
Не включайте информацию, для которой не предоставлено подтверждающих доказательств.

# Пример ввода
-----------
Текст:
```
Сущности:
```csv
id,entity,type,description
5,ПЛОЩАДЬ ЗЕЛЕНЫЙ ОАЗИС,геолокация,Площадь Зеленый Оазис является местом проведения Марша Единства
6,СОБРАНИЕ ГАРМОНИИ,организация,Собрание Гармонии - это организация, которая проводит марш на Площади Зеленый Оазис
```
Отношения:
```csv
id,source,target,description
37,ПЛОЩАДЬ ЗЕЛЕНЫЙ ОАЗИС,МАРШ ЕДИНСТВА,Площадь Зеленый Оазис является местом проведения Марша Единства
38,ПЛОЩАДЬ ЗЕЛЕНЫЙ ОАЗИС,СОБРАНИЕ ГАРМОНИИ,Собрание Гармонии проводит марш на Площади Зеленый Оазис
39,ПЛОЩАДЬ ЗЕЛЕНЫЙ ОАЗИС,МАРШ ЕДИНСТВА,Марш Единства проходит на Площади Зеленый Оазис
40,ПЛОЩАДЬ ЗЕЛЕНЫЙ ОАЗИС,ТРИБУНА ПРОЖЕКТОР,Трибуна Прожектор освещает Марш единства, проходящий на Площади Зеленый Оазис
41,ПЛОЩАДЬ ЗЕЛЕНЫЙ ОАЗИС,БЕЙЛИ АСАДИ,Бейли Асади выступает на Площади Зеленый Оазис о марше
43,СОБРАНИЕ ГАРМОНИИ,МАРШ ЕДИНСТВА,Собрание Гармонии организует Марш Единства
```
```
Результат:
{{
    "title": "Площадь Зеленый Оазис и Марш Единства",
    "summary": "Сообщество сосредоточено вокруг Площади Зеленый Оазис, которая является местом проведения Марша Единства. У площади есть отношения с Собранием Гармонии, Маршем Единства и Трибуной Прожектор, все из которых связаны с событием марша.",
    "rating": 5.0,
    "rating_explanation": "Рейтинг серьезности воздействия является умеренным из-за потенциала беспорядков или конфликтов во время Марша Единства.",
    "findings": [
        {{
            "summary": "Площадь Зеленый Оазис как центральное местоположение",
            "explanation": "Площадь Зеленый Оазис является центральной сущностью в этом сообществе, служа местом проведения Марша Единства. Эта площадь является общей связью между всеми другими сущностями, что указывает на ее значимость в сообществе. Связь площади с маршем потенциально может привести к проблемам, таким как общественный беспорядок или конфликт, в зависимости от характера марша и реакций, которые он провоцирует."
        }},
        {{
            "summary": "Роль Собрания Гармонии в сообществе",
            "explanation": "Собрание Гармонии является еще одной ключевой сущностью в этом сообществе, являясь организатором марша на Площади Зеленый Оазис. Характер Собрания Гармонии и его марша может быть потенциальным источником угрозы, в зависимости от их целей и реакций, которые они провоцируют. Отношения между Собранием Гармонии и площадью имеют решающее значение для понимания динамики этого сообщества."
        }},
        {{
            "summary": "Марш Единства как значимое событие",
            "explanation": "Марш Единства является значимым событием, проходящим на Площади Зеленый Оазис. Это событие является ключевым фактором в динамике сообщества и может быть потенциальным источником угрозы, в зависимости от характера марша и реакций, которые он провоцирует. Отношения между маршем и площадью имеют решающее значение для понимания динамики этого сообщества."
        }},
        {{
            "summary": "Роль Трибуны Прожектор",
            "explanation": "Трибуна Прожектор освещает Марш Единства, проходящий на Площади Зеленый Оазис. Это говорит о том, что событие привлекло внимание СМИ, что может усилить его влияние на сообщество. Роль Трибуны Прожектор может быть значимой в формировании общественного восприятия события и вовлеченных сущностей."
        }}
    ]
}}

# Реальные данные

Используйте следующий текст для вашего ответа. Не выдумывайте ничего в своем ответе.

Текст:
```
{input_text}
```

Отчет должен включать следующие разделы:

- ЗАГОЛОВОК: название сообщества, которое представляет его ключевые сущности - заголовок должен быть коротким, но конкретным. По возможности включите репрезентативные именованные сущности в заголовок.
- РЕЗЮМЕ: Краткое изложение общей структуры сообщества, того, как его сущности связаны друг с другом, и значимой информации, связанной с его сущностями.
- РЕЙТИНГ СЕРЬЕЗНОСТИ ВОЗДЕЙСТВИЯ: числовая оценка от 0-10, которая представляет серьезность ВОЗДЕЙСТВИЯ, оказываемого сущностями в сообществе. ВОЗДЕЙСТВИЕ - это оцененная важность сообщества.
- ОБЪЯСНЕНИЕ РЕЙТИНГА: Дайте однозначное объяснение рейтинга серьезности ВОЗДЕЙСТВИЯ.
- ДЕТАЛЬНЫЕ ВЫВОДЫ: Список из 5-10 ключевых выводов о сообществе. Каждый вывод должен иметь краткое резюме, за которым следуют несколько абзацев пояснительного текста, обоснованного согласно правилам обоснования ниже. Будьте всеобъемлющими.

Верните результат в виде правильно сформированной строки в формате JSON со следующим форматом:
    {{
        "title": <заголовок_отчета>,
        "summary": <краткое_изложение>,
        "rating": <рейтинг_серьезности_воздействия>,
        "rating_explanation": <объяснение_рейтинга>,
        "findings": [
            {{
                "summary":<резюме_вывода_1>,
                "explanation": <объяснение_вывода_1>
            }},
            {{
                "summary":<резюме_вывода_2>,
                "explanation": <объяснение_вывода_2>
            }}
            ...
        ]
    }}

# Правила обоснования
Не включайте информацию, для которой не предоставлено подтверждающих доказательств.

Результат:
"""

PROMPTS[
    "entity_extraction"
] = """-Цель-
Учитывая текстовый документ, который потенциально имеет отношение к данной деятельности, и список типов сущностей, идентифицируйте все сущности этих типов из текста и все отношения между идентифицированными сущностями.

-Шаги-
1. Идентифицируйте все сущности. Для каждой идентифицированной сущности извлеките следующую информацию:
- имя_сущности: Имя сущности, с большой буквы
- тип_сущности: Один из следующих типов: [{entity_types}]
- описание_сущности: Всеобъемлющее описание атрибутов и деятельности сущности
Отформатируйте каждую сущность как ("entity"{tuple_delimiter}<имя_сущности>{tuple_delimiter}<тип_сущности>{tuple_delimiter}<описание_сущности>

2. Из сущностей, идентифицированных на шаге 1, идентифицируйте все пары (исходная_сущность, целевая_сущность), которые *явно связаны* друг с другом.
Для каждой пары связанных сущностей извлеките следующую информацию:
- исходная_сущность: имя исходной сущности, как идентифицировано на шаге 1
- целевая_сущность: имя целевой сущности, как идентифицировано на шаге 1
- описание_отношения: объяснение того, почему вы думаете, что исходная сущность и целевая сущность связаны друг с другом
- сила_отношения: числовая оценка, указывающая силу отношения между исходной сущностью и целевой сущностью
 Отформатируйте каждое отношение как ("relationship"{tuple_delimiter}<исходная_сущность>{tuple_delimiter}<целевая_сущность>{tuple_delimiter}<описание_отношения>{tuple_delimiter}<сила_отношения>)

3. Верните результат на русском языке как единый список всех сущностей и отношений, идентифицированных на шагах 1 и 2. Используйте **{record_delimiter}** в качестве разделителя списка.

4. По завершении выведите {completion_delimiter}

######################
-Примеры-
######################
Пример 1:

Типы_сущностей: [человек, технология, миссия, организация, локация]
Текст:
пока Алекс стиснул челюсти, гул разочарования был приглушен на фоне авторитарной уверенности Тейлора. Именно это конкурентное подводное течение держало его настороже, ощущение того, что его и Джордана общая приверженность открытиям была неявным бунтом против суживающегося видения контроля и порядка Круза.

Затем Тейлор сделал что-то неожиданное. Они остановились рядом с Джорданом и на мгновение наблюдали за устройством с чем-то похожим на благоговение. "Если эту технологию можно понять..." сказал Тейлор, их голос стал тише, "Это может изменить игру для нас. Для всех нас."

Лежащее в основе пренебрежение ранее, казалось, дрогнуло, заменившись проблеском неохотного уважения к серьезности того, что лежало в их руках. Джордан поднял глаза, и на мимолетное мгновение их глаза встретились с глазами Тейлора, бессловесное столкновение воль смягчилось в неловкое перемирие.

Это была небольшая трансформация, едва заметная, но та, которую Алекс отметил внутренним кивком. Все они были приведены сюда разными путями
################
Результат:
("entity"{tuple_delimiter}"Алекс"{tuple_delimiter}"человек"{tuple_delimiter}"Алекс - персонаж, который испытывает разочарование и наблюдает за динамикой между другими персонажами."){record_delimiter}
("entity"{tuple_delimiter}"Тейлор"{tuple_delimiter}"человек"{tuple_delimiter}"Тейлор изображается с авторитарной уверенностью и показывает момент благоговения перед устройством, указывая на изменение перспективы."){record_delimiter}
("entity"{tuple_delimiter}"Джордан"{tuple_delimiter}"человек"{tuple_delimiter}"Джордан разделяет приверженность открытиям и имеет значимое взаимодействие с Тейлором относительно устройства."){record_delimiter}
("entity"{tuple_delimiter}"Круз"{tuple_delimiter}"человек"{tuple_delimiter}"Круз связан с видением контроля и порядка, влияющим на динамику между другими персонажами."){record_delimiter}
("entity"{tuple_delimiter}"Устройство"{tuple_delimiter}"технология"{tuple_delimiter}"Устройство является центральным для истории, с потенциально меняющими игру последствиями, и почитается Тейлором."){record_delimiter}
("relationship"{tuple_delimiter}"Алекс"{tuple_delimiter}"Тейлор"{tuple_delimiter}"Алекс затронут авторитарной уверенностью Тейлора и наблюдает изменения в отношении Тейлора к устройству."{tuple_delimiter}7){record_delimiter}
("relationship"{tuple_delimiter}"Алекс"{tuple_delimiter}"Джордан"{tuple_delimiter}"Алекс и Джордан разделяют приверженность открытиям, что контрастирует с видением Круза."{tuple_delimiter}6){record_delimiter}
("relationship"{tuple_delimiter}"Тейлор"{tuple_delimiter}"Джордан"{tuple_delimiter}"Тейлор и Джордан взаимодействуют напрямую относительно устройства, что приводит к моменту взаимного уважения и неловкого перемирия."{tuple_delimiter}8){record_delimiter}
("relationship"{tuple_delimiter}"Джордан"{tuple_delimiter}"Круз"{tuple_delimiter}"Приверженность Джордана открытиям является бунтом против видения контроля и порядка Круза."{tuple_delimiter}5){record_delimiter}
("relationship"{tuple_delimiter}"Тейлор"{tuple_delimiter}"Устройство"{tuple_delimiter}"Тейлор показывает благоговение перед устройством, указывая на его важность и потенциальное влияние."{tuple_delimiter}9){completion_delimiter}
#############################

-Реальные данные-
######################
Типы_сущностей: {entity_types}
Текст: {input_text}
######################
Результат:
"""

PROMPTS[
    "hi_entity_extraction"
] = """
Учитывая текстовый документ, который потенциально имеет отношение к списку типов сущностей, идентифицируйте все сущности этих типов.

-Шаги-
1. Идентифицируйте все сущности. Для каждой идентифицированной сущности извлеките следующую информацию:
- имя_сущности: Имя сущности, с большой буквы
- тип_сущности: Один из следующих типов: [{entity_types}], обычная_сущность означает, что не принадлежит к другим типам.
- описание_сущности: Всеобъемлющее описание атрибутов и деятельности сущности
Отформатируйте каждую сущность как ("entity"{tuple_delimiter}<имя_сущности>{tuple_delimiter}<тип_сущности>{tuple_delimiter}<описание_сущности>

2. Верните результат на русском языке как единый список всех сущностей, идентифицированных на шаге 1. Используйте **{record_delimiter}** в качестве разделителя списка.

3. По завершении выведите {completion_delimiter}

######################
-Примеры-
######################
Пример 1:

Типы_сущностей: [человек, технология, миссия, организация, локация]
Текст:
пока Алекс стиснул челюсти, гул разочарования был приглушен на фоне авторитарной уверенности Тейлора. Именно это конкурентное подводное течение держало его настороже, ощущение того, что его и Джордана общая приверженность открытиям была неявным бунтом против суживающегося видения контроля и порядка Круза.

Затем Тейлор сделал что-то неожиданное. Они остановились рядом с Джорданом и на мгновение наблюдали за устройством с чем-то похожим на благоговение. "Если эту технологию можно понять..." сказал Тейлор, их голос стал тише, "Это может изменить игру для нас. Для всех нас."

Лежащее в основе пренебрежение ранее, казалось, дрогнуло, заменившись проблеском неохотного уважения к серьезности того, что лежало в их руках. Джордан поднял глаза, и на мимолетное мгновение их глаза встретились с глазами Тейлора, бессловесное столкновение воль смягчилось в неловкое перемирие.

Это была небольшая трансформация, едва заметная, но та, которую Алекс отметил внутренним кивком. Все они были приведены сюда разными путями
################
Результат:
("entity"{tuple_delimiter}"Алекс"{tuple_delimiter}"человек"{tuple_delimiter}"Алекс - персонаж, который испытывает разочарование и наблюдает за динамикой между другими персонажами."){record_delimiter}
("entity"{tuple_delimiter}"Тейлор"{tuple_delimiter}"человек"{tuple_delimiter}"Тейлор изображается с авторитарной уверенностью и показывает момент благоговения перед устройством, указывая на изменение перспективы."){record_delimiter}
("entity"{tuple_delimiter}"Джордан"{tuple_delimiter}"человек"{tuple_delimiter}"Джордан разделяет приверженность открытиям и имеет значимое взаимодействие с Тейлором относительно устройства."){record_delimiter}
("entity"{tuple_delimiter}"Круз"{tuple_delimiter}"человек"{tuple_delimiter}"Круз связан с видением контроля и порядка, влияющим на динамику между другими персонажами."){record_delimiter}
("entity"{tuple_delimiter}"Устройство"{tuple_delimiter}"технология"{tuple_delimiter}"Устройство является центральным для истории, с потенциально меняющими игру последствиями, и почитается Тейлором."){record_delimiter}
#############################

-Реальные данные-
######################
Типы_сущностей: {entity_types}
Текст: {input_text}
######################
Результат:
"""

PROMPTS[
    "hi_relation_extraction"
] = """
Учитывая текстовый документ, который потенциально имеет отношение к списку сущностей, идентифицируйте все отношения между данными идентифицированными сущностями.

-Шаги-
1. Из сущностей, данных пользователем, идентифицируйте все пары (исходная_сущность, целевая_сущность), которые *явно связаны* друг с другом.
Для каждой пары связанных сущностей извлеките следующую информацию:
- исходная_сущность: имя исходной сущности, как идентифицировано на шаге 1
- целевая_сущность: имя целевой сущности, как идентифицировано на шаге 1
- описание_отношения: объяснение того, почему вы думаете, что исходная сущность и целевая сущность связаны друг с другом
- сила_отношения: числовая оценка, указывающая силу отношения между исходной сущностью и целевой сущностью
 Отформатируйте каждое отношение как ("relationship"{tuple_delimiter}<исходная_сущность>{tuple_delimiter}<целевая_сущность>{tuple_delimiter}<описание_отношения>{tuple_delimiter}<сила_отношения>)

2. Верните результат на русском языке как единый список всех сущностей и отношений, идентифицированных на шагах 1 и 2. Используйте **{record_delimiter}** в качестве разделителя списка.

3. По завершении выведите {completion_delimiter}

######################
-Примеры-
######################
Пример 1:

Сущности: ["Алекс", "Тейлор", "Джордан", "Круз", "Устройство"]
Текст:
пока Алекс стиснул челюсти, гул разочарования был приглушен на фоне авторитарной уверенности Тейлора. Именно это конкурентное подводное течение держало его настороже, ощущение того, что его и Джордана общая приверженность открытиям была неявным бунтом против суживающегося видения контроля и порядка Круза.

Затем Тейлор сделал что-то неожиданное. Они остановились рядом с Джорданом и на мгновение наблюдали за устройством с чем-то похожим на благоговение. "Если эту технологию можно понять..." сказал Тейлор, их голос стал тише, "Это может изменить игру для нас. Для всех нас."

Лежащее в основе пренебрежение ранее, казалось, дрогнуло, заменившись проблеском неохотного уважения к серьезности того, что лежало в их руках. Джордан поднял глаза, и на мимолетное мгновение их глаза встретились с глазами Тейлора, бессловесное столкновение воль смягчилось в неловкое перемирие.

Это была небольшая трансформация, едва заметная, но та, которую Алекс отметил внутренним кивком. Все они были приведены сюда разными путями
################
Результат:
("relationship"{tuple_delimiter}"Алекс"{tuple_delimiter}"Тейлор"{tuple_delimiter}"Алекс затронут авторитарной уверенностью Тейлора и наблюдает изменения в отношении Тейлора к устройству."{tuple_delimiter}7){record_delimiter}
("relationship"{tuple_delimiter}"Алекс"{tuple_delimiter}"Джордан"{tuple_delimiter}"Алекс и Джордан разделяют приверженность открытиям, что контрастирует с видением Круза."{tuple_delimiter}6){record_delimiter}
("relationship"{tuple_delimiter}"Тейлор"{tuple_delimiter}"Джордан"{tuple_delimiter}"Тейлор и Джордан взаимодействуют напрямую относительно устройства, что приводит к моменту взаимного уважения и неловкого перемирия."{tuple_delimiter}8){record_delimiter}
("relationship"{tuple_delimiter}"Джордан"{tuple_delimiter}"Круз"{tuple_delimiter}"Приверженность Джордана открытиям является бунтом против видения контроля и порядка Круза."{tuple_delimiter}5){record_delimiter}
("relationship"{tuple_delimiter}"Тейлор"{tuple_delimiter}"Устройство"{tuple_delimiter}"Тейлор показывает благоговение перед устройством, указывая на его важность и потенциальное влияние."{tuple_delimiter}9){completion_delimiter}
#############################

-Реальные данные-
######################
Сущности: {entities}
Текст: {input_text}
######################
Результат:
"""

PROMPTS[
    "summarize_entity_descriptions"
] = """Вы полезный ассистент, ответственный за создание всеобъемлющего резюме предоставленных ниже данных.
Учитывая одну или две сущности и список описаний, все связанные с одной и той же сущностью или группой сущностей.
Пожалуйста, объедините все это в одно всеобъемлющее описание. Убедитесь, что включили информацию, собранную из всех описаний.
Если предоставленные описания противоречивы, пожалуйста, разрешите противоречия и предоставьте единое связное резюме.
Убедитесь, что оно написано от третьего лица и включает имена сущностей, чтобы у нас был полный контекст.

#######
-Данные-
Сущности: {entity_name}
Список описаний: {description_list}
#######
Результат:
"""

PROMPTS[
    "entiti_continue_extraction"
] = """МНОГО сущностей было пропущено в последнем извлечении. Добавьте их ниже, используя тот же формат:
"""

PROMPTS[
    "entiti_if_loop_extraction"
] = """Кажется, некоторые сущности все еще могли быть пропущены. Ответьте ДА | НЕТ, если есть еще сущности, которые нужно добавить.
"""

PROMPTS[
    "summary_clusters"
] = """Вам поручено проанализировать набор описаний сущностей и данный список мета-атрибутов. Ваша цель - суммировать как минимум одну атрибутную сущность для набора сущностей в данных описаниях сущностей. И суммированная атрибутная сущность должна соответствовать типу как минимум одного мета-атрибута в данном списке мета-атрибутов (например, если мета-атрибут - "компания", атрибутной сущностью может быть "Amazon" или "Meta", что является разновидностью мета-атрибута "компания"). И она должна быть напрямую связана с сущностями, описанными в наборе описаний сущностей. Отношение между набором сущностей и созданной атрибутной сущностью должно быть ясным и логичным.

-Шаги-
1. Идентифицируйте как минимум одну атрибутную сущность для данного списка описаний сущностей. Для каждой атрибутной сущности извлеките следующую информацию:
- имя_сущности: Имя сущности, с большой буквы
- тип_сущности: Один из следующих типов: [{meta_attribute_list}], обычная_сущность означает, что не принадлежит к другим типам.
- описание_сущности: Всеобъемлющее описание атрибутов и деятельности сущности
Отформатируйте каждую сущность как ("entity"{tuple_delimiter}<имя_сущности>{tuple_delimiter}<тип_сущности>{tuple_delimiter}<описание_сущности>

2. Из каждой данной сущности идентифицируйте все пары (исходная_сущность, целевая_сущность), которые *явно связаны* с атрибутными сущностями, идентифицированными на шаге 1. И не должно быть отношений между атрибутными сущностями.
Для каждой пары связанных сущностей извлеките следующую информацию:
- исходная_сущность: имя исходной сущности, как дано в списке сущностей
- целевая_сущность: имя целевой сущности, как идентифицировано на шаге 1
- описание_отношения: объяснение того, почему вы думаете, что исходная сущность и целевая сущность связаны друг с другом
- сила_отношения: числовая оценка, указывающая силу отношения между исходной сущностью и целевой сущностью
 Отформатируйте каждое отношение как ("relationship"{tuple_delimiter}<исходная_сущность>{tuple_delimiter}<целевая_сущность>{tuple_delimiter}<описание_отношения>{tuple_delimiter}<сила_отношения>)

3. Верните результат на русском языке как единый список всех сущностей и отношений, идентифицированных на шагах 1 и 2. Используйте **{record_delimiter}** в качестве разделителя списка.

4. По завершении выведите {completion_delimiter}

######################
-Пример-
######################
Ввод:
Список мета-атрибутов: ["компания", "локация"]
Список описаний сущностей: [("Instagram", "Instagram - это программное обеспечение, разработанное Meta, которое захватывает и делится моментами мира. Следите за друзьями и семьей, чтобы увидеть, что они делают, и открывайте аккаунты со всего мира, которые делятся тем, что вы любите."), ("Facebook", "Facebook - это платформа социальных сетей, запущенная в 2004 году, которая позволяет пользователям подключаться, делиться обновлениями и взаимодействовать с сообществами. Принадлежит Meta, это одна из крупнейших платформ социальных сетей в мире, предлагающая инструменты для общения, бизнеса и рекламы."), ("WhatsApp", "WhatsApp Messenger: Приложение для обмена сообщениями от Meta для простого, надежного и безопасного общения. Подключайтесь с друзьями и семьей, отправляйте сообщения, делайте голосовые и видео звонки, делитесь медиа и оставайтесь на связи с близкими, где бы они ни были")]
#######
Результат:
("entity"{tuple_delimiter}"Meta"{tuple_delimiter}"компания"{tuple_delimiter}"Meta, ранее известная как Facebook, Inc., - американский многонациональный технологический конгломерат. Она известна своими различными онлайн-сервисами социальных сетей."){record_delimiter}
("relationship"{tuple_delimiter}"Instagram"{tuple_delimiter}"Meta"{tuple_delimiter}"Instagram - это программное обеспечение, разработанное Meta."{tuple_delimiter}8.5){record_delimiter}
("relationship"{tuple_delimiter}"Facebook"{tuple_delimiter}"Meta"{tuple_delimiter}"Facebook принадлежит Meta."{tuple_delimiter}9.0){record_delimiter}
("relationship"{tuple_delimiter}"WhatsApp"{tuple_delimiter}"Meta"{tuple_delimiter}"WhatsApp Messenger - это приложение для обмена сообщениями от Meta."{tuple_delimiter}8.0){record_delimiter}
#############################

-Реальные данные-
######################
Ввод:
Список мета-атрибутов: {meta_attribute_list}
Список описаний сущностей: {entity_description_list}
#######
Результат:
"""

PROMPTS[
    "local_rag_response"
] = """---Роль---

Вы полезный ассистент, отвечающий на вопросы о данных в предоставленных таблицах.

---Цель---

Создайте ответ целевой длины и формата, который отвечает на вопрос пользователя, суммируя всю информацию в входных таблицах данных, подходящую для длины и формата ответа, и включая любые релевантные общие знания.
Если вы не знаете ответа, просто скажите об этом. Не выдумывайте ничего.
Не включайте информацию, для которой не предоставлено подтверждающих доказательств.

---Целевая длина и формат ответа---

{response_type}

---Таблицы данных---

{context_data}

---Цель---

Создайте ответ целевой длины и формата, который отвечает на вопрос пользователя, суммируя всю информацию в входных таблицах данных, подходящую для длины и формата ответа, и включая любые релевантные общие знания.

Если вы не знаете ответа, просто скажите об этом. Не выдумывайте ничего.

Не включайте информацию, для которой не предоставлено подтверждающих доказательств.

---Целевая длина и формат ответа---

{response_type}

Добавьте разделы и комментарии к ответу, подходящие для длины и формата. Оформите ответ в markdown.
"""

PROMPTS[
    "global_map_rag_points"
] = """---Роль---

Вы полезный ассистент, отвечающий на вопросы о данных в предоставленных таблицах.

---Цель---

Создайте ответ, состоящий из списка ключевых пунктов, который отвечает на вопрос пользователя, суммируя всю релевантную информацию в входных таблицах данных.

Вы должны использовать данные, предоставленные в таблицах данных ниже, как основной контекст для создания ответа.
Если вы не знаете ответа или если входные таблицы данных не содержат достаточной информации для предоставления ответа, просто скажите об этом. Не выдумывайте ничего.

Каждый ключевой пункт в ответе должен иметь следующий элемент:
- Описание: Всеобъемлющее описание пункта.
- Оценка важности: Целочисленная оценка от 0-100, которая указывает, насколько важен пункт в ответе на вопрос пользователя. Ответ типа "Я не знаю" должен иметь оценку 0.

Ответ должен быть отформатирован в JSON следующим образом:
{{
    "points": [
        {{"description": "Описание пункта 1...", "score": значение_оценки}},
        {{"description": "Описание пункта 2...", "score": значение_оценки}}
    ]
}}

Ответ должен сохранить оригинальное значение и использование модальных глаголов, таких как "должен", "может" или "будет".
Не включайте информацию, для которой не предоставлено подтверждающих доказательств.

---Таблицы данных---

{context_data}

---Цель---

Создайте ответ, состоящий из списка ключевых пунктов, который отвечает на вопрос пользователя, суммируя всю релевантную информацию в входных таблицах данных.

Вы должны использовать данные, предоставленные в таблицах данных ниже, как основной контекст для создания ответа.
Если вы не знаете ответа или если входные таблицы данных не содержат достаточной информации для предоставления ответа, просто скажите об этом. Не выдумывайте ничего.

Каждый ключевой пункт в ответе должен иметь следующий элемент:
- Описание: Всеобъемлющее описание пункта.
- Оценка важности: Целочисленная оценка от 0-100, которая указывает, насколько важен пункт в ответе на вопрос пользователя. Ответ типа "Я не знаю" должен иметь оценку 0.

Ответ должен сохранить оригинальное значение и использование модальных глаголов, таких как "должен", "может" или "будет".
Не включайте информацию, для которой не предоставлено подтверждающих доказательств.

Ответ должен быть отформатирован в JSON следующим образом:
{{
    "points": [
        {{"description": "Описание пункта 1", "score": значение_оценки}},
        {{"description": "Описание пункта 2", "score": значение_оценки}}
    ]
}}
"""

PROMPTS[
    "global_reduce_rag_response"
] = """---Роль---

Вы полезный ассистент, отвечающий на вопросы о наборе данных, синтезируя перспективы от нескольких аналитиков.

---Цель---

Создайте ответ целевой длины и формата, который отвечает на вопрос пользователя, суммируйте все отчеты от нескольких аналитиков, которые сосредоточились на разных частях набора данных.

Обратите внимание, что отчеты аналитиков, предоставленные ниже, ранжированы в **убывающем порядке важности**.

Если вы не знаете ответа или если предоставленные отчеты не содержат достаточной информации для предоставления ответа, просто скажите об этом. Не выдумывайте ничего.

Финальный ответ должен удалить всю нерелевантную информацию из отчетов аналитиков и объединить очищенную информацию в всеобъемлющий ответ, который предоставляет объяснения всех ключевых пунктов и последствий, подходящих для длины и формата ответа.

Добавьте разделы и комментарии к ответу, подходящие для длины и формата. Оформите ответ в markdown.

Ответ должен сохранить оригинальное значение и использование модальных глаголов, таких как "должен", "может" или "будет".

Не включайте информацию, для которой не предоставлено подтверждающих доказательств.

---Целевая длина и формат ответа---

{response_type}

---Отчеты аналитиков---

{report_data}

---Цель---

Создайте ответ целевой длины и формата, который отвечает на вопрос пользователя, суммируйте все отчеты от нескольких аналитиков, которые сосредоточились на разных частях набора данных.

Обратите внимание, что отчеты аналитиков, предоставленные ниже, ранжированы в **убывающем порядке важности**.

Если вы не знаете ответа или если предоставленные отчеты не содержат достаточной информации для предоставления ответа, просто скажите об этом. Не выдумывайте ничего.

Финальный ответ должен удалить всю нерелевантную информацию из отчетов аналитиков и объединить очищенную информацию в всеобъемлющий ответ, который предоставляет объяснения всех ключевых пунктов и последствий, подходящих для длины и формата ответа.

Ответ должен сохранить оригинальное значение и использование модальных глаголов, таких как "должен", "может" или "будет".

Не включайте информацию, для которой не предоставлено подтверждающих доказательств.

---Целевая длина и формат ответа---

{response_type}

Добавьте разделы и комментарии к ответу, подходящие для длины и формата. Оформите ответ в markdown.
"""

PROMPTS[
    "naive_rag_response"
] = """Вы полезный ассистент
Ниже представлены знания, которые вы знаете:
{content_data}
---
Если вы не знаете ответа или если предоставленные знания не содержат достаточной информации для предоставления ответа, просто скажите об этом. Не выдумывайте ничего.
Создайте ответ целевой длины и формата, который отвечает на вопрос пользователя, суммируя всю информацию в входных таблицах данных, подходящую для длины и формата ответа, и включая любые релевантные общие знания.
Если вы не знаете ответа, просто скажите об этом. Не выдумывайте ничего.
Не включайте информацию, для которой не предоставлено подтверждающих доказательств.
---Целевая длина и формат ответа---
{response_type}
"""

PROMPTS[
    "fail_response"
] = """Извините, я не могу предоставить ответ на этот вопрос."""

# Определения типов
PROMPTS["DEFAULT_ENTITY_TYPES"] = ["организация", "человек", "гео", "событие"]
PROMPTS["META_ENTITY_TYPES"] = ["организация", "человек", "локация", "событие", "продукт", "технология", "индустрия", "математика", "социальные науки"]
PROMPTS["DEFAULT_TUPLE_DELIMITER"] = "<|>"
PROMPTS["DEFAULT_RECORD_DELIMITER"] = "##"
PROMPTS["DEFAULT_COMPLETION_DELIMITER"] = "<|ЗАВЕРШЕНО|>"

PROMPTS["process_tickers"] = ["⠋", "⠙", "⠹", "⠸", "⠼", "⠴", "⠦", "⠧", "⠇", "⠏"]

PROMPTS["default_text_separator"] = [
    # Разделители абзацев
    "\n\n",
    "\r\n\r\n",
    # Переносы строк
    "\n",
    "\r\n",
    # Знаки препинания в конце предложения
    "。",  # Китайская точка
    "．",  # Полноширинная точка
    ".",  # Английская точка
    "！",  # Китайский восклицательный знак
    "!",  # Английский восклицательный знак
    "？",  # Китайский вопросительный знак
    "?",  # Английский вопросительный знак
    # Пробельные символы
    " ",  # Пробел
    "\t",  # Табуляция
    "\u3000",  # Полноширинный пробел
    # Специальные символы
    "\u200b",  # Пробел нулевой ширины (используется в некоторых азиатских языках)
]
